# InfoSec Advisory — Release bundle E2/E3/E17

- **Commit**: `test` @ `f34a994`
- **Дата**: 2025-09-20T23:15Z
- **Запуски**:
  - Semgrep `p/ci` (1.137.0) — 0 findings, timeout на `.next/.../427.js` (артефакт).
- Bandit 1.8.6 (`bandit -r backend web bot`) — 39 детектов; см. JSON `reports/infosec/bandit-2025-09-20.json`.
  - Trivy — не запускался (на CI; добавить в DevOps чеклист).
  - Trivy 2025-09-23 (локально) — CRITICAL/HIGH не обнаружены (после обновления `fastapi` 0.117.1 / `starlette` 0.48.0).

## MUST
1. `backend/db/repair.py` (Bandit B608 MEDIUM) — устранено в ветке `feature/E2/sql-repair-param` (параметризация SQL). Требуется убедиться в попадании фикса в релиз перед Gate-5.
2. `requirements.txt` (`starlette 0.38.6`) — закрыто 2025-09-23 апгрейдом до `fastapi 0.117.1` / `starlette 0.48.0`, подтверждено Trivy 2025-09-23.

## SHOULD
1. `bot/handlers/telegram.py` — возможные «секреты» `'paid'` (B105). Исправлено в ветке `feature/release/bot-status-default-be` (по умолчанию используется `ProductStatus.paid`), требует попадания в релиз.
2. Subprocess вызовы (`web/routes/index.py`, `backend/scripts/db_dump.py`, `web/routes/system.py`) — закрыто в ветке `feature/release/subprocess-hardening-devops` (абсолютные пути, таймауты, контроль допустимых команд).

## COULD / FYI
- Многочисленные `try/except pass/continue` (B110/B112) — рассмотреть логирование.
- `assert` в `web/routes/auth.py` (B101) — заменить на явные проверки.

## Рекомендации
- Запускать security-сканеры в virtualenv: установка Semgrep обновила `opentelemetry-*` и `httpx`, что конфликтует с текущими версиями (см. лог `pip`). До деплоя вернуть совместимые версии или выполнить сканер в отдельном окружении.
- Добавить Trivy `fs` сканирование в CI (см. обновлённый runbook).
